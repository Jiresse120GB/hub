type: trigger
name: crowdsecurity/aws-cis-benchmark-login-no-mfa
description: "Detect login without MFA to the AWS console"
filter: |
    evt.Meta.log_type == 'aws-cloudtrail' &&
    evt.Meta.event_name == "ConsoleLogin" &&
    evt.Unmarshaled.cloudtrail.additionalEventData.MFAUsed != "Yes" &&
    evt.Unmarshaled.cloudtrail.userIdentity.type == "IAMUser" &&
    evt.Unmarshaled.cloudtrail.responseElements.ConsoleLogin == "Success"
labels:
  confidence: 2
  spoofable: 0
  classification:
   - attack.T1552
   - attack.T1078.004
  behavior: "cloud:credential-misuse"
  label: "AWS Credential misuse"
  service: aws
  remediation: false